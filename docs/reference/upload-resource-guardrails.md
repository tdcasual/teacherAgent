# 上传与资源限额基线

- 适用角色：管理员、平台负责人、开发者
- 最后验证日期：2026-02-15
- 主要来源：`docs/plans/2026-02-13-code-audit-findings.md`

## 目标
防止上传链路成为资源耗尽入口（内存、磁盘、I/O）。

## 服务端基线规则
1. 限制上传文件数量（按场景区分）。
2. 限制单文件大小（例如 20MB）。
3. 限制单请求总上传体积（例如 80MB）。
4. 扩展名 + MIME 双白名单校验。
5. 流式写入过程中实时校验，超限立即中断。
6. 请求失败时清理本次临时文件，避免垃圾落盘。

## 客户端协同规则
1. 上传前做数量/大小/类型预检。
2. 校验失败在前端直接提示并阻断请求。
3. 前后端限额配置需保持一致并可追踪。

## 审计与监控建议
- 记录上传拒绝原因（超限、类型不允许、总量超标）。
- 监控高失败率上传端点与磁盘增长速率。
- 将反复超限行为纳入安全告警。

## 相关文档
- `docs/how-to/auth-and-account-troubleshooting.md`
- `docs/reference/risk-register.md`
- `docs/plans/2026-02-13-code-audit-findings.md`
