[UI/Interaction Analysis Report]

1. Code Architecture & Maintainability
- **Monolithic Components**: Both `student/src/App.tsx` and `teacher/src/App.tsx` are excessively large (Teacher app > 4600 lines). This violates separation of concerns. Logic, UI, styling, and data fetching are tightly coupled.
- **Code Duplication**: Significant logic is duplicated between Student and Teacher apps, including:
    - Markdown & Math rendering configuration (unified/remark/rehype pipelines).
    - Utility functions (`makeId`, `nowTime`, `timeFromIso`).
    - Polling logic for chat status and jobs.
    - Type definitions.
- **Recommendation**: Extract shared logic into a common library or shared directory. Refactor `App.tsx` into smaller, feature-specific components (e.g., `ChatWindow`, `UploadPanel`, `SessionList`). Move types to `types.ts`.

2. State Management
- **Excessive Local State**: The Teacher app uses dozens of `useState` hooks. This makes state tracking difficult and debugging complex.
- **Recommendation**: Adopt a global state management solution (Zustand, Redux, or React Context) to manage app-wide state like user sessions, settings, and active jobs.

3. Interaction & UX
- **Native Browser Dialogs**: Usage of `window.prompt` (for renaming sessions) and `window.confirm` (for archiving) provides a poor, inconsistent user experience and styling that cannot be controlled.
- **Recommendation**: Replace native dialogs with custom React Modal components that match the application's design system.
- **Polling Logic**: Polling is implemented manually with `setTimeout` in `useEffect`. This is error-prone (e.g., potential for race conditions, memory leaks if not cleaned up perfectly, inconsistent backoff logic).
- **Recommendation**: Use a data fetching library like `TanStack Query` (React Query) or `SWR` which handles polling, caching, and revalidation robustly.

4. Performance & Best Practices
- **Re-renders**: With all state in the root component, any state change (e.g., typing in the input box) likely triggers re-renders of the entire application tree.
- **Hooks Dependencies**: The code suppresses `react-hooks/exhaustive-deps` warnings in several `useEffect` blocks. This often indicates potential bugs where effects use stale data or don't update when they should.
- **Recommendation**: Memoize components (`React.memo`) and callback functions (`useCallback`). Push state down to leaf components. Fix `useEffect` dependencies instead of suppressing warnings.

5. Specific Logic Issues
- **`dangerouslySetInnerHTML`**: Used for rendering chat messages. While `rehype-sanitize` is configured, this remains a high-risk area for XSS if the sanitation schema is not strictly maintained.
- **Hardcoded Configuration**: `DEFAULT_API_URL` and other constants are hardcoded in multiple files.
