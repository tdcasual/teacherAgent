# Security Incident Response Runbook

Last updated: 2026-02-15

## 目标

在安全事件发生时，确保响应过程具备：

1. 快速止损
2. 证据保全
3. 可追溯复盘

## 事件分级

### SEV-1（严重）

- 凭据泄露、权限绕过、生产数据外泄、核心流程不可用。
- 要求：
  1. 立即启动应急流程；
  2. 15 分钟内完成首次通报；
  3. 优先止损，后补业务恢复细节。

### SEV-2（高）

- 可利用漏洞已公开但未确认被利用，或关键服务有明显异常趋势。
- 要求：
  1. 1 小时内完成风险评估与处置计划；
  2. 当天给出补丁或临时缓解。

### SEV-3（中/低）

- 需修复但暂未形成直接生产风险。
- 要求：
  1. 纳入正常迭代；
  2. 记录到风险登记并设置复审日期。

## 标准处置流程

1. 发现与确认
   - 收集事件来源（告警、用户报告、审计日志）。
   - 确认影响范围（模块、角色、租户、时间窗口）。
2. 立即止损
   - 回滚最近变更、关闭高风险入口、轮换相关凭据。
   - 必要时启用降级开关保持核心服务可用。
3. 证据保全
   - 导出相关审计日志、CI 记录、部署记录。
   - 保留最小复现材料，避免污染证据链。
4. 修复与验证
   - 先补回归测试，再提交修复。
   - 在 PR 中附验证证据与回滚方案。
5. 沟通与复盘
   - 输出时间线、根因、影响评估、改进行动项。
   - 更新风险登记和相关治理文档。

## 响应职责

1. Incident Commander（值守负责人）
   - 决策分级、协调响应节奏、统一对外沟通口径。
2. Technical Owner（技术负责人）
   - 制定修复方案并执行验证。
3. Scribe（记录员）
   - 记录时间线、操作命令、关键证据链接。

## 检查清单

1. 凭据是否已轮换（如 token secret、管理员口令）。
2. 高风险入口是否已临时封禁或限流。
3. 审计日志是否覆盖事件窗口并可导出。
4. 修复是否包含自动化回归测试。
5. 风险登记是否更新复审日期与退出条件。

## 关联文档

1. `SECURITY.md`
2. `CONTRIBUTING.md`
3. `docs/reference/risk-register.md`
4. `docs/operations/change-management-and-governance.md`
